% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pdStrategy.R
\name{pdStrategy}
\alias{pdStrategy}
\title{pdStrategy: Partial Dependence Tree Strategy (R6 class)}
\description{
pdStrategy: Partial Dependence Tree Strategy (R6 class)

pdStrategy: Partial Dependence Tree Strategy (R6 class)
}
\details{
Implements the effectStrategy interface for building and analyzing Partial Dependence (PD) trees.
This strategy supports data preprocessing, node transformation, heterogeneity calculation,
best split search, tree fitting, and visualization.


This class is used internally by the gadgetTree framework to implement partial dependence
tree growing, splitting, and visualization. It is not intended to be used directly by end users,
but can be instantiated for advanced customization.
}
\examples{
# Example: Fit and plot a PD tree using pdStrategy and gadgetTree
# (Assuming effect and data are prepared)
pd_strat = pdStrategy$new()
tree = gadgetTree$new(strategy = pd_strat, n.split = 2)
tree$fit(effect, data, target.feature.name = "target")
tree$plot(effect, data, target.feature.name = "target")

}
\section{Super class}{
\code{\link[gadget:effectStrategy]{gadget::effectStrategy}} -> \code{pdStrategy}
}
\section{Public fields}{
\if{html}{\out{<div class="r6-fields">}}
\describe{
\item{\code{tree_ref}}{Reference to the associated tree instance.}
}
\if{html}{\out{</div>}}
}
\section{Methods}{
\subsection{Public methods}{
\itemize{
\item \href{#method-pdStrategy-new}{\code{pdStrategy$new()}}
\item \href{#method-pdStrategy-preprocess}{\code{pdStrategy$preprocess()}}
\item \href{#method-pdStrategy-node_transform}{\code{pdStrategy$node_transform()}}
\item \href{#method-pdStrategy-heterogeneity}{\code{pdStrategy$heterogeneity()}}
\item \href{#method-pdStrategy-find_best_split}{\code{pdStrategy$find_best_split()}}
\item \href{#method-pdStrategy-plot}{\code{pdStrategy$plot()}}
\item \href{#method-pdStrategy-fit}{\code{pdStrategy$fit()}}
\item \href{#method-pdStrategy-clone}{\code{pdStrategy$clone()}}
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-new"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-new}{}}}
\subsection{Method \code{new()}}{
Initialize the strategy with name "pd".
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$new()}\if{html}{\out{</div>}}
}

}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-preprocess"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-preprocess}{}}}
\subsection{Method \code{preprocess()}}{
Preprocess input data to generate the split feature set Z, effect list Y, and grid.
Applies character-to-factor conversion and data-driven level ordering for
categorical split features via \code{order_categorical_levels}.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$preprocess(
  effect,
  data,
  target.feature,
  feature.set = NULL,
  split.feature = NULL,
  order.method = "mds"
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{effect}}{R6 object or list.\cr
An object containing feature effect results, typically from FeatureEffect or FeatureEffects.}

\item{\code{data}}{Data frame.\cr
Data frame containing all features and the target variable.}

\item{\code{target.feature}}{Character(1).\cr
The name of the target feature in the data to explain.}

\item{\code{feature.set}}{Character or NULL. \cr
Optional. Subset of features to use for effect calculation. If NULL, all features are used.}

\item{\code{split.feature}}{Character or NULL. \cr
Optional. Features to consider for splitting at each node. If NULL, all features are considered.}

\item{\code{order.method}}{Character. Categorical level order: \code{"mds"}, \code{"pca"},
\code{"random"}, or \code{"raw"} (keep existing factor level order;
default \code{"mds"}).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List. \cr
  A list with Z (split feature set), Y (effect list), and grid (feature grid).
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-node_transform"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-node_transform}{}}}
\subsection{Method \code{node_transform()}}{
Mean-center the effect list Y within the node and return the centered list.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$node_transform(Y, grid, idx)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{Y}}{List. Each element is an effect matrix for a feature.}

\item{\code{grid}}{List. Feature grids.}

\item{\code{idx}}{Integer. Sample indices for the current node.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List. List of centered effects.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-heterogeneity"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-heterogeneity}{}}}
\subsection{Method \code{heterogeneity()}}{
Calculate the heterogeneity (sum of variances) of effects within the node.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$heterogeneity(Y)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{Y}}{List. List of effect matrices.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
Numeric. Numeric vector, heterogeneity for each feature.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-find_best_split"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-find_best_split}{}}}
\subsection{Method \code{find_best_split()}}{
Find the best split point for a node.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$find_best_split(Z, Y, min.node.size, n.quantiles)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{Z}}{Data frame. Split feature set.}

\item{\code{Y}}{List. Effect matrices.}

\item{\code{min.node.size}}{Integer(1). Minimum node size.}

\item{\code{n.quantiles}}{Integer(1) or NULL. \cr
Optional. Number of quantiles to use for candidate split points (for numeric features).
If NULL, use default.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List. List with best split feature, split point, etc.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-plot"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-plot}{}}}
\subsection{Method \code{plot()}}{
Visualize the PD tree structure and partial dependence plots for each node.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$plot(
  tree,
  effect,
  data,
  target.feature.name,
  depth = NULL,
  node.id = NULL,
  features = NULL,
  ...
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{tree}}{List. Tree structure as a list of Node objects.}

\item{\code{effect}}{R6 object or list. Model effect object.}

\item{\code{data}}{Data frame. Data frame.}

\item{\code{target.feature.name}}{Character(1). Target feature name.}

\item{\code{depth}}{Integer or NULL. Depth(s) to visualize (optional).}

\item{\code{node.id}}{Integer or NULL. Node id(s) to visualize (optional).}

\item{\code{features}}{Character or NULL. Features to visualize (optional).}

\item{\code{...}}{Additional plotting arguments.}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
List. List of ggplot2 objects for different depths and nodes.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-fit"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-fit}{}}}
\subsection{Method \code{fit()}}{
Fit a PD tree using the provided data and effect object.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$fit(
  tree,
  effect,
  data,
  target.feature.name,
  feature.set = NULL,
  split.feature = NULL,
  order.method = "mds",
  ...
)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{tree}}{gadgetTree object. Tree object instance.}

\item{\code{effect}}{R6 object or list. Model effect object.}

\item{\code{data}}{Data frame. Data frame.}

\item{\code{target.feature.name}}{Character(1). Target feature name.}

\item{\code{feature.set}}{Character or NULL. Feature subset (optional).}

\item{\code{split.feature}}{Character or NULL. Split feature (optional).}

\item{\code{order.method}}{Character. Categorical level order passed to
\code{prepare_split_data_pd} and \code{order_categorical_levels}:
\code{"mds"}, \code{"pca"}, \code{"random"}, or \code{"raw"}
(default \code{"mds"}).}

\item{\code{...}}{Additional arguments (ignored).}
}
\if{html}{\out{</div>}}
}
\subsection{Returns}{
gadgetTree object, invisibly. The fitted tree object.
}
}
\if{html}{\out{<hr>}}
\if{html}{\out{<a id="method-pdStrategy-clone"></a>}}
\if{latex}{\out{\hypertarget{method-pdStrategy-clone}{}}}
\subsection{Method \code{clone()}}{
The objects of this class are cloneable with this method.
\subsection{Usage}{
\if{html}{\out{<div class="r">}}\preformatted{pdStrategy$clone(deep = FALSE)}\if{html}{\out{</div>}}
}

\subsection{Arguments}{
\if{html}{\out{<div class="arguments">}}
\describe{
\item{\code{deep}}{Whether to make a deep clone.}
}
\if{html}{\out{</div>}}
}
}
}
